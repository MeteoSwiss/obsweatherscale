obsweatherscale.kernels.neural_kernel
=====================================

.. py:module:: obsweatherscale.kernels.neural_kernel


Classes
-------

.. autoapisummary::

   obsweatherscale.kernels.neural_kernel.NeuralKernel


Module Contents
---------------

.. py:class:: NeuralKernel(net: torch.nn.Module, kernel: gpytorch.kernels.Kernel)

   Bases: :py:obj:`gpytorch.kernels.Kernel`


   Neural Kernel class.

   This class implements a neural kernel that transforms the input data
   to a learned feature space using a neural network before applying
   the kernel function.

   TODO: add reference


   .. py:attribute:: net


   .. py:attribute:: kernel


   .. py:method:: forward(x1: torch.Tensor, x2: torch.Tensor, *params: Any, **kwargs: Any) -> Union[torch.Tensor, linear_operator.operators.LinearOperator]

      Computes the covariance between :math:`\mathbf x_1` and :math:`\mathbf x_2`.
      This method should be implemented by all Kernel subclasses.

      :param x1: First set of data (... x N x D).
      :param x2: Second set of data (... x M x D).
      :param diag: Should the Kernel compute the whole kernel, or just the diag?
          If True, it must be the case that `x1 == x2`. (Default: False.)
      :param last_dim_is_batch: If True, treat the last dimension
          of `x1` and `x2` as another batch dimension.
          (Useful for additive structure over the dimensions). (Default: False.)

      :return: The kernel matrix or vector. The shape depends on the kernel's evaluation mode:

          * `full_covar`: `... x N x M`
          * `full_covar` with `last_dim_is_batch=True`: `... x K x N x M`
          * `diag`: `... x N`
          * `diag` with `last_dim_is_batch=True`: `... x K x N`



